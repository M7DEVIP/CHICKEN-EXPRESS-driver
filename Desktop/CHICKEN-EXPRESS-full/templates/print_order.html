<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>طباعة الطلب</title>
</head>
<body>
    <h1>طباعة الطلب</h1>
    <form id="printForm" action="{{ url_for('print_order') }}" method="POST">
        <label for="ordercode">أدخل كود الطلب:</label>
        <input type="text" id="ordercode" name="ordercode" required>
        <button type="submit">طباعة الطلب</button>
    </form>
    {% if error %}
        <p style="color: red;">{{ error }}</p>
    {% endif %}
    <iframe id="pdfIframe" style="display: none;"></iframe>
    <script>
        document.getElementById('printForm').onsubmit = function(event) {
            event.preventDefault();
            var formData = new FormData(this);
            fetch(this.action, {
                method: 'POST',
                body: formData
            }).then(response => response.json())
              .then(data => {
                  if (data.pdf_url) {
                      var iframe = document.getElementById('pdfIframe');
                      iframe.onload = function() {
                          iframe.contentWindow.print();
                      };
                      iframe.src = data.pdf_url;
                  }
              });
        };
    </script>
</body>
</html>
