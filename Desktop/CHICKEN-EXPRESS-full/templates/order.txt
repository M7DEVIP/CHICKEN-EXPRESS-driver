<!DOCTYPE html>
<html>
<head>
    <title>CHICKEN EXPRESS Home</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        /* أنماط CSS لشريط التنقل */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background-color: red;
            padding: 10px;
            color: white;
            display: flex; /* لجعل العناصر داخل شريط التنقل تعرض بترتيب أفقي */
            justify-content: space-between; /* لتوزيع العناصر في المساحة الأفقية بالتساوي */
        }

        /* أنماط CSS لاسم الموظف */
        .employee-name {
            float: left;
            margin-left: 10px;
            cursor: pointer;
            font-size: 19px;
        }

        /* أنماط CSS للخيارات في الجانب الأيمن */
        .navbar-options {
            display: flex;
            cursor: pointer;
        }

        /* أنماط CSS لكل خيار */
        .navbar-option {
            margin-left: 27px;
            cursor: pointer;
            font-size: 19px;
        }

        .home-btn-nav {
            margin-right: 15px;
            font-weight: bold;
        }

        .search-box {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 72px;
        }

        .search-box-order {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 72px;
        }
    

        .search-input-order {
            width: 381px;
            height: 43px;
            border: 1px solid #d51a1a;
            border-radius: 81px;
            padding-left: 26px;
            outline: none;
            font-size: 16px;
        }


        .search-input:focus {
            border: 3px solid #d51a1a;
        }

        .search-input-order:focus {
            border: 3px solid #d51a1a;
        }

        .search-box i {
            position: absolute;
            top: 93px;
            right: 590px;
            transform: translateY(-50%);
            opacity: 44%;
        }

        .search-box-order i {
            position: absolute;
            top: 94px;
            right: 590px;
            transform: translateY(-50%);
            opacity: 44%;
        }

        .card {
            background-color: #fff;
            border: 1px solid #dda7a7;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgb(94, 32, 32);
            padding: 11px;
            width: 300px;
            margin: 20px;
            border-radius: 12px;
            color: #191717;
        }

        .card-header {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .card-container {
            display: flex;
            flex-wrap: unset;
            gap: 0px;
            background-color: #f63535;
            overflow: scroll;
        }

        .card {
            background-color: #fff;
            border: 1px solid #dda7a7;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgb(94, 32, 32);
            padding: 11px;
            width: 300px;
            margin: 20px;
            border-radius: 12px;
            color: #191717;
            font-size: 18px;
        }

        .card-header {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: right;
        }

        .card-info {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .card-info i {
            margin-right: 10px;
        }

        .card-info strong {
            font-weight: bold;
        }

        .card-note {
            margin-top: 10px;
            color: #888;
        }

        .fa-phone {
            color: #78db55;
        }

        .fa-venus-mars {
            color: #b2327a;
        }


        .fa-map-marker-alt {
            
        }

        .fa-utensils {
            color: #9598aa;
        }

        .fa-sticky-note {
            color: #e1cb52;
        }

        .card-buttons {
            display: inline-flex;
        }
      
          .edit-button,
          .request-button {
            padding: 5px 10px;
            margin-left: 2px;
            display: none;
            background-color: transparent;
            color: rgb(235, 164, 27);
            border: 0;
            cursor: pointer;
        }

        .request-button {
            margin-left: -10px;
            color: #31c38c;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
            overflow: hidden;
        }
    
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 37%;
            border-radius: 25px;
            margin-top: 102px;
        }
    
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
    
        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
    
        h2 {
            text-align: center;
        }
    
        #customer-form input[type="text"] {
            width: 100%;
            padding: 12px 20px;
            margin: 8px 0;
            display: inline-block;
            border: 1px solid #ccc;
            box-sizing: border-box;
            border-radius: 10px;
        }
    
        .modal-footer {
            text-align: center;
            margin-top: 20px;
        }
    
        #save-changes-button,
        #save-new-button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            cursor: pointer;
            margin-right: 5px;
            border-radius: 4px;
        }

        
    
        #close-modal-button {
            background-color: #aaa;
            color: white;
            padding: 10px 20px;
            border: none;
            cursor: pointer;
            border-radius: 4px;
        }
    
        #save-changes-button:hover,
        #close-modal-button:hover {
            opacity: 0.8;
        }

        .select-wrapper {
            position: relative;
            display: inline-block;
            font-family: Arial, sans-serif;
            color: #333;
          }
        
          .select-wrapper select {
            width: 200px;
            padding: 10px;
            font-size: 16px;
            border: none;
            border-radius: 4px;
            background-color: #f2f2f2;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            appearance: none;
            outline: none;
            cursor: pointer;
          }
        
          .select-wrapper::after {
            content: '\25BC';
            position: absolute;
            top: 50%;
            right: 10px;
            transform: translateY(-50%);
            color: #888;
            pointer-events: none;
          }

        .card-add-button {
            display: flex;
            align-items: center;
            width: 100%;
            height: 100%;
            margin-left: 104px;
            margin-top: 34px;
        }
    
        .card-add-button i {
            font-size: 114px;
            color: #f63535;
        }

        .add-modal-content {
            background-color: #fefefe;
            margin: 15% auto;
                margin-top: 15%;
            padding: 20px;
            border: 1px solid #888;
            width: 37%;
            border-radius: 25px;
            margin-top: 102px;
            height: 66%;
        }

        .ct {
            text-align: center;
            margin-top: -18px;
            margin-bottom: 3px;
            color: #888585;
            font-size: 22px;
        }

        #floating-form-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
          }
          
          #floating-form {
            background-color: #ffffff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            width: 547px;
          }
          
          #floating-form h2 {
            text-align: center;
            margin-bottom: 20px;
          }
          
          #floating-form form {
            display: grid;
            gap: 15px;
          }
          
          #floating-form input,
          #floating-form textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            margin: -13px;
                margin-top: -13px;
            margin-top: 10px;
          }
          
          #floating-form textarea {
            resize: vertical;
            min-height: 80px;
          }
          
          #floating-form button {
            background-color: #4caf50;
            border: none;
            color: #ffffff;
            padding: 12px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 5px;
          }
          
          #floating-form button:hover {
            background-color: #45a049;
          }
          
          #floating-form input::placeholder,
          #floating-form textarea::placeholder {
            color: #000;
          }

          .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
        }
        
        .modal2 {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
        }
        
        .close-btn2 {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
        }

        .selectbtn {
            border: none;
            color: #fff;
            padding: 10px 15px !important;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 12px !important;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 35px !important;
            background-color: #0d6c13b2;
        }

        select {
            background-color: #f2f2f2;
            border: none;
            border-radius: 4px;
            padding: 10px;
            width: 200px;
            font-size: 16px;
            color: #555;
        }
    
        /* تنسيق الخيارات */
        select option {
            background-color: #fff;
            color: #555;
        }
    
        /* تنسيق الخيار المحدد */
        select option:checked {
            background-color: #007bff;
            color: #fff;
        }

        .openmenubtn {
            background-color: #4caf50;
            border: none;
            color: #ffffff;
            padding: 12px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            border-radius: 95px;
            cursor: pointer;
            margin-top: -6px;
        }

        .restaurant-menu {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
          }
          
          .menu-category {
            width: 100%;
            text-align: center;
            margin: 20px 0;
          }
          
          .menu-item {
            text-align: center;
            width: 250px;
            margin: 20px;
          }
          
          .item-image img {
            width: 150px;
            height: 150px;
            object-fit: cover;
            border-radius: 50%;
          }
          
          .item-details {
            margin-top: 10px;
          }
          
          .item-details h2 {
            font-size: 18px;
            margin-bottom: 5px;
          }
          
          .item-details p {
            margin: 0;
          }
          
          .add-button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 8px 16px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
            margin-top: 10px;
            cursor: pointer;
            border-radius: 4px;
          }
          
          .quantity {
            display: flex;
            justify-content: center;
            align-items: center;
          }
          
          .quantity-button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 5px 10px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
            margin: 0 5px;
            cursor: pointer;
            border-radius: 4px;
          }
          
          .hidden {
            display: none;
          }
          
          nav {
              position: fixed;
              top: 0;
              right: 0;
              bottom: 0;
              padding: 20px;
              background-color: transform;
              display: flex;
              flex-direction: column;
              justify-content: flex-start;
            }
            
            nav a {
              text-decoration: none;
              color: #443838;
              font-weight: bold;
              font-size: 12px;
              writing-mode: vertical-lr;
              transform: rotate(180deg);
              white-space: nowrap;
              padding: 10px 20px;
              background-color: #88dba0a1;
              border: 1px solid #3caa52;
              margin-bottom: 10px;
              margin-right: -28px;
              border-radius: 10px;
            }
            
            nav a:last-child {
              margin-bottom: 0;
            }
      
            #order-summary {
              position: fixed;
              top: 10px;
              right: 1269px;
              width: 214px;
              background-color: #f8f9fa;
              border: 1px solid #ddd;
              border-radius: 8px;
              padding: 20px;
              box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
          }
      
          #order-summary h2 {
              margin-top: 0;
              font-size: 21px;
              color: #333
          }
      
          #order-list {
              list-style: none;
              padding: 0;
              margin: 0 0 10px 0;
          }
      
          #order-list li {
              padding: 10px;
              border-bottom: 1px solid #ddd;
          }
      
          #total-price {
              font-size: 18px;
              color: #333;
              margin: 0;
          }
      
          #total-price span {
              font-weight: bold;
              color: #e67e22;
          }
          .menu-container-han {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #fff;
            z-index: 99999;
            display: flex;
            justify-content: center;
            align-items: center;
            display: none;
          }
        
    </style>
</head>
<body>
  <div class="navbar">
    <div class="employee-name">
        {{ username }}
    </div>
    <div class="navbar-options">
      <div class="navbar-option">
        menu
      </div>
      <div class="navbar-option" onclick="redirectToCustomer()">
        customers
      </div>
      <div class="navbar-option home-btn-nav">
        Home
      </div>
    </div>
  </div>

    <!--ORDER-->

    <div class="search-box-order">
        <input type="text" class="search-input-order" placeholder="Find order">
        <i class="fas fa-search"></i>
    </div>
    
    <br/>
    
    <div>
        <br />
        <div class="card-container">
            {% for order in order_data %}
            {% if order.name or order.phone or order.order or order.address or order.note or order.status %}
            <div class="card">
                <div class="card-header">
                    <span class="customer-name">{{ order.ordercode }}</span>
                    <div class="card-buttons">
                        {% if order.status == "new" %}
                            <button id="edit-modal-button" class="edit-button btn-primary" data-phone="{{ order.phone }}">
                                <i class="fas fa-edit"></i>
                            </button>
                        {% endif %}
                    </div>
                </div>
                {% if order.phone %}
                <div class="card-info">
                    <i class="fas fa-phone"></i>
                    <span>{{ order.phone }}</span>
                </div>
                {% endif %}
                {% if order.name %}
                <div class="card-info">
                    <i class="fas fa-user"></i>
                    <span>{{ order.name }}</span>
                </div>
                {% endif %}
                {% if order.order %}
                <div class="card-info">
                    <i class="fas fa-utensils"></i>
                    <span>{{ order.order }}</span>
                </div>
                {% endif %}
                {% if order.address %}
                <div class="card-info">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>{{ order.address }}</span>
                </div>
                {% endif %}
                {% if order.date %}
                <div class="card-info">
                    <i class="far fa-calendar"></i>
                    <span>{{ order.date }}</span>
                </div>
                {% endif %}
                {% if order.time %}
                <div class="card-info">
                    <i class="far fa-clock"></i>
                    <span>{{ order.time }}</span>
                </div>
                {% endif %}
                {% if order.status %}
                <div class="card-info">
                    <i class="fas fa-info-circle"></i>
                    <span>{{ order.status }}</span>
                </div>
                {% endif %}
                {% if order.note %}
                <div class="card-note">
                    <i class="fas fa-sticky-note"></i>
                    <span>{{ order.note }}</span>
                </div>
                {% endif %}
            </div>
            {% endif %}
            {% endfor %}
    
            <!-- بطاقة جديدة -->
            <div class="card" onclick="makeorder()" style="cursor: pointer;">
                <div class="card-header">
                    <div class="card-add-button">
                        <i class="fas fa-plus"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="menu-container-han" id="menu-container-han">
        <nav>
            <a href="#main-dishes">الوجبات الرئيسية</a>
            <a href="#snacks">الوجبات الخفيفة</a>
            <a href="#appetizers">المقبلات</a>
            <a href="#beverages">المشروبات</a>
        </nav>
    
        <div id="order-summary">
            <h2>الطلب</h2>
            <ul id="order-list"></ul>
            <p id="total-price">السعر الإجمالي: <span>0</span> دينار</p>
        </div>
    
        <div class="restaurant-menu">
            <div class="menu-category">
                <h2 id="main-dishes">الوجبات الرئيسية</h2>
            </div>
                {% for row in rows %}
                    {% if row[4] == 1 and row[6] == "وجبة" %}
                        <div class="menu-item">
                            <div class="item-image">
                                <img src="{{ row[5] }}" alt="{{ row[1] }}">
                            </div>
                            <div class="item-details">
                                <h2>{{ row[1] }}</h2>
                                <p>وصف: {{ row[2] }}</p>
                                <p>سعر: {{ row[3] }} دينار</p>
                                <button class="add-button" onclick="toggleAddButton(this)">إضافة</button>
                                <div class="quantity hidden">
                                    <button class="quantity-button">-</button>
                                    <span>0</span>
                                    <button class="quantity-button">+</button>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
    
    
            <div class="menu-category">
                <h2 id="snacks">الوجبات السريعة</h2>
            </div>
            {% for row in rows %}
                    {% if row[4] == 1 and row[6] == "سريعة" %}
                        <div class="menu-item">
                            <div class="item-image">
                                <img src="{{ row[5] }}" alt="{{ row[1] }}">
                            </div>
                            <div class="item-details">
                                <h2>{{ row[1] }}</h2>
                                <p>وصف: {{ row[2] }}</p>
                                <p>سعر: {{ row[3] }} دينار</p>
                                <button class="add-button" onclick="toggleAddButton(this)">إضافة</button>
                                <div class="quantity hidden">
                                    <button class="quantity-button">-</button>
                                    <span>0</span>
                                    <button class="quantity-button">+</button>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
    
            <div class="menu-category">
                <h2 id="appetizers">المقبلات</h2>
            </div>
            {% for row in rows %}
                    {% if row[4] == 1 and row[6] == "مقبلات" %}
                        <div class="menu-item">
                            <div class="item-image">
                                <img src="{{ row[5] }}" alt="{{ row[1] }}">
                            </div>
                            <div class="item-details">
                                <h2>{{ row[1] }}</h2>
                                <p>وصف: {{ row[2] }}</p>
                                <p>سعر: {{ row[3] }} دينار</p>
                                <button class="add-button" onclick="toggleAddButton(this)">إضافة</button>
                                <div class="quantity hidden">
                                    <button class="quantity-button">-</button>
                                    <span>0</span>
                                    <button class="quantity-button">+</button>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
    
            <div class="menu-category">
                <h2 id="beverages">المشروبات</h2>
            </div>
            {% for row in rows %}
                    {% if row[4] == 1 and row[6] == "مشروب" %}
                        <div class="menu-item">
                            <div class="item-image">
                                <img src="{{ row[5] }}" alt="{{ row[1] }}">
                            </div>
                            <div class="item-details">
                                <h2>{{ row[1] }}</h2>
                                <p>وصف: {{ row[2] }}</p>
                                <p>سعر: {{ row[3] }} دينار</p>
                                <button class="add-button" onclick="toggleAddButton(this)">إضافة</button>
                                <div class="quantity hidden">
                                    <button class="quantity-button">-</button>
                                    <span>0</span>
                                    <button class="quantity-button">+</button>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
    
    
        </div>
    </div>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>

        function makeorder() {
            document.getElementById("menu-container-han").style.display = "block";
        }
 
    
        function redirectToCustomer() {
            fetch('/customerwin')
              .then(function(response) {
                if (response.ok) {
                  window.location.href = "/customerwin";
                } else {
                  console.log('حدث خطأ في الطلب.');
                }
              })
              .catch(function(error) {
                console.log('حدث خطأ في الاتصال.', error);
              });
        }
    
        //--------------------------------
    
        function searchOrders() {
            var input = searchInputOrder.value.toUpperCase();
            var cards = document.querySelectorAll('.card');
        
            cards.forEach(function(card) {
                var orderCode = card.querySelector('.customer-name');
                var orderCodeText = orderCode.textContent || orderCode.innerText;
                
                var orderPhone = card.querySelector('.card-info:nth-child(2) span:nth-child(2)');
                var orderPhoneText = orderPhone.textContent || orderPhone.innerText;
                
                var orderName = card.querySelector('.card-info:nth-child(3) span:nth-child(2)');
                var orderNameText = orderName.textContent || orderName.innerText;
        
                if (orderCodeText.toUpperCase().indexOf(input) > -1 || 
                    orderPhoneText.toUpperCase().indexOf(input) > -1 || 
                    orderNameText.toUpperCase().indexOf(input) > -1) {
                    card.style.display = "";
                } else {
                    card.style.display = "none";
                }
            });
        }
    
        var searchInputOrder = document.querySelector('.search-input-order');
        searchInputOrder.addEventListener('keyup', searchOrders);
        

        // order & Edit

        var cards = document.querySelectorAll('.card');
    
        function showCardButtons() {
            var editButton = this.querySelector('.edit-button');
            var requestButton = this.querySelector('.request-button');
            
            editButton.style.display = "inline-block";
            requestButton.style.display = "inline-block";
        }
        
        function hideCardButtons() {
            var editButton = this.querySelector('.edit-button');
            var requestButton = this.querySelector('.request-button');
            
            editButton.style.display = "none";
            requestButton.style.display = "none";
        }
        
        cards.forEach(function(card) {
            card.addEventListener('mouseover', showCardButtons);
            card.addEventListener('mouseout', hideCardButtons);
        });

        //menuuuuu

        function toggleAddButton(button) {
            button.classList.add("hidden");
            var quantityDiv = button.nextElementSibling;
            var quantitySpan = quantityDiv.querySelector("span");
            quantitySpan.innerHTML = "1";  // تحديث الكمية إلى 1 عند النقر على زر "إضافة"
            quantityDiv.classList.remove("hidden");
            var quantityButtons = quantityDiv.getElementsByTagName("button");
            for (var i = 0; i < quantityButtons.length; i++) {
                quantityButtons[i].addEventListener("click", handleQuantityButtonClick);
            }
            updateOrderSummary();  // تحديث ملخص الطلب عند النقر على زر "إضافة"
        }
    
        function handleQuantityButtonClick(event) {
            var button = event.target;
            var quantitySpan = button.parentNode.querySelector("span");
            var quantity = parseInt(quantitySpan.innerHTML);
    
            if (button.classList.contains("quantity-button")) {
                if (button.innerHTML === "+") {
                    quantity++;
                } else if (button.innerHTML === "-") {
                    if (quantity > 0) {
                        quantity--;
                    }
                }
                quantitySpan.innerHTML = quantity;
            }
    
            if (quantity === 0 && !button.classList.contains("add-button")) {
                return;
            }
    
            if (quantity === 0) {
                var quantityDiv = button.parentNode;
                quantityDiv.classList.add("hidden");
                var addButton = quantityDiv.parentNode.querySelector(".add-button");
                addButton.classList.remove("hidden");
            }
    
            updateOrderSummary();
        }
    
        function updateOrderSummary() {
            var orderList = document.getElementById("order-list");
            var totalPriceSpan = document.querySelector("#total-price span");
    
            // Clear the current order list
            orderList.innerHTML = "";
    
            // Rebuild the order list
            var menuItems = document.querySelectorAll(".menu-item");
            var total = 0;
    
            menuItems.forEach(function (menuItem) {
                var quantitySpan = menuItem.querySelector(".quantity span");
                var quantity = parseInt(quantitySpan.innerHTML);
    
                if (quantity > 0) {
                    var itemName = menuItem.querySelector("h2").innerHTML;
                    var price = parseFloat(menuItem.querySelector("p:nth-child(3)").innerHTML.split(': ')[1]);
                    var itemTotalPrice = quantity * price;
    
                    var listItem = document.createElement("li");
                    listItem.innerHTML = itemName + ": " + quantity + " x " + itemTotalPrice.toFixed(2) + " دينار";
                    orderList.appendChild(listItem);
    
                    total += itemTotalPrice;
                }
            });
    
            totalPriceSpan.innerHTML = total.toFixed(2);
        }
    
    </script>
</body>
</html>