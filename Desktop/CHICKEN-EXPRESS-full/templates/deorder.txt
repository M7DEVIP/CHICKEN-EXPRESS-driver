<!DOCTYPE html>
<html>
<head>
    <title>CHICKEN EXPRESS Home</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        /* أنماط CSS لشريط التنقل */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background-color: red;
            padding: 10px;
            color: white;
            display: flex; /* لجعل العناصر داخل شريط التنقل تعرض بترتيب أفقي */
            justify-content: space-between; /* لتوزيع العناصر في المساحة الأفقية بالتساوي */
        }

        /* أنماط CSS لاسم الموظف */
        .employee-name {
            float: left;
            margin-left: 10px;
            cursor: pointer;
            font-size: 19px;
        }

        /* أنماط CSS للخيارات في الجانب الأيمن */
        .navbar-options {
            display: flex;
            cursor: pointer;
        }

        /* أنماط CSS لكل خيار */
        .navbar-option {
            margin-left: 27px;
            cursor: pointer;
            font-size: 19px;
        }

        .home-btn-nav {
            margin-right: 15px;
            font-weight: bold;
        }

        .search-box {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 72px;
        }

        .search-box-order {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 72px;
        }
    

        .search-input-order {
            width: 381px;
            height: 43px;
            border: 1px solid #d51a1a;
            border-radius: 81px;
            padding-left: 26px;
            outline: none;
            font-size: 16px;
        }


        .search-input:focus {
            border: 3px solid #d51a1a;
        }

        .search-input-order:focus {
            border: 3px solid #d51a1a;
        }

        .search-box i {
            position: absolute;
            top: 93px;
            right: 590px;
            transform: translateY(-50%);
            opacity: 44%;
        }

        .search-box-order i {
            position: absolute;
            top: 94px;
            right: 590px;
            transform: translateY(-50%);
            opacity: 44%;
        }

        .card {
            background-color: #fff;
            border: 1px solid #dda7a7;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgb(94, 32, 32);
            padding: 11px;
            width: 300px;
            margin: 20px;
            border-radius: 12px;
            color: #191717;
        }

        .card-header {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .card-container {
            display: flex;
            flex-wrap: unset;
            gap: 0px;
            background-color: #f63535;
            overflow: scroll;
        }

        .card {
            background-color: #fff;
            border: 1px solid #dda7a7;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgb(94, 32, 32);
            padding: 11px;
            width: 300px;
            margin: 20px;
            border-radius: 12px;
            color: #191717;
            font-size: 18px;
        }

        .card-header {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: right;
        }

        .card-info {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }

        .card-info i {
            margin-right: 10px;
        }

        .card-info strong {
            font-weight: bold;
        }

        .card-note {
            margin-top: 10px;
            color: #888;
        }

        .fa-phone {
            color: #78db55;
        }

        .fa-venus-mars {
            color: #b2327a;
        }


        .fa-map-marker-alt {
            
        }

        .fa-utensils {
            color: #9598aa;
        }

        .fa-sticky-note {
            color: #e1cb52;
        }

        .card-buttons {
            display: inline-flex;
        }
      
          .edit-button,
          .request-button {
            padding: 5px 10px;
            margin-left: 2px;
            display: none;
            background-color: transparent;
            color: rgb(235, 164, 27);
            border: 0;
            cursor: pointer;
        }

        .request-button {
            margin-left: -10px;
            color: #31c38c;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
            overflow: hidden;
        }
    
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 37%;
            border-radius: 25px;
            margin-top: 102px;
        }
    
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
    
        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
    
        h2 {
            text-align: center;
        }
    
        #customer-form input[type="text"] {
            width: 100%;
            padding: 12px 20px;
            margin: 8px 0;
            display: inline-block;
            border: 1px solid #ccc;
            box-sizing: border-box;
            border-radius: 10px;
        }
    
        .modal-footer {
            text-align: center;
            margin-top: 20px;
        }
    
        #save-changes-button,
        #save-new-button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            cursor: pointer;
            margin-right: 5px;
            border-radius: 4px;
        }

        
    
        #close-modal-button {
            background-color: #aaa;
            color: white;
            padding: 10px 20px;
            border: none;
            cursor: pointer;
            border-radius: 4px;
        }
    
        #save-changes-button:hover,
        #close-modal-button:hover {
            opacity: 0.8;
        }

        .select-wrapper {
            position: relative;
            display: inline-block;
            font-family: Arial, sans-serif;
            color: #333;
          }
        
          .select-wrapper select {
            width: 200px;
            padding: 10px;
            font-size: 16px;
            border: none;
            border-radius: 4px;
            background-color: #f2f2f2;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            appearance: none;
            outline: none;
            cursor: pointer;
          }
        
          .select-wrapper::after {
            content: '\25BC';
            position: absolute;
            top: 50%;
            right: 10px;
            transform: translateY(-50%);
            color: #888;
            pointer-events: none;
          }

        .card-add-button {
            display: flex;
            align-items: center;
            width: 100%;
            height: 100%;
            margin-left: 104px;
            margin-top: 34px;
        }
    
        .card-add-button i {
            font-size: 114px;
            color: #f63535;
        }

        .add-modal-content {
            background-color: #fefefe;
            margin: 15% auto;
                margin-top: 15%;
            padding: 20px;
            border: 1px solid #888;
            width: 37%;
            border-radius: 25px;
            margin-top: 102px;
            height: 66%;
        }

        .ct {
            text-align: center;
            margin-top: -18px;
            margin-bottom: 3px;
            color: #888585;
            font-size: 22px;
        }

        #floating-form-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
          }
          
          #floating-form {
            background-color: #ffffff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            width: 547px;
          }
          
          #floating-form h2 {
            text-align: center;
            margin-bottom: 20px;
          }
          
          #floating-form form {
            display: grid;
            gap: 15px;
          }
          
          #floating-form input,
          #floating-form textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            margin: -13px;
                margin-top: -13px;
            margin-top: 10px;
          }
          
          #floating-form textarea {
            resize: vertical;
            min-height: 80px;
          }
          
          #floating-form button {
            background-color: #4caf50;
            border: none;
            color: #ffffff;
            padding: 12px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 5px;
          }
          
          #floating-form button:hover {
            background-color: #45a049;
          }
          
          #floating-form input::placeholder,
          #floating-form textarea::placeholder {
            color: #000;
          }

          .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
        }
        
        .modal2 {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
        }
        
        .close-btn2 {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
        }

        .selectbtn {
            border: none;
            color: #fff;
            padding: 10px 15px !important;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 12px !important;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 35px !important;
            background-color: #0d6c13b2;
        }

        select {
            background-color: #f2f2f2;
            border: none;
            border-radius: 4px;
            padding: 10px;
            width: 200px;
            font-size: 16px;
            color: #555;
        }
    
        /* تنسيق الخيارات */
        select option {
            background-color: #fff;
            color: #555;
        }
    
        /* تنسيق الخيار المحدد */
        select option:checked {
            background-color: #007bff;
            color: #fff;
        }

        .openmenubtn {
            background-color: #4caf50;
            border: none;
            color: #ffffff;
            padding: 12px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            border-radius: 95px;
            cursor: pointer;
            margin-top: -6px;
        }
        
    </style>
</head>
<body>
  <div class="navbar">
    <div class="employee-name">
        {{ username }}
    </div>
    <div class="navbar-options">
      <div class="navbar-option">
        menu
      </div>
      <div class="navbar-option" onclick="redirectToCustomer()">
        customers
      </div>
      <div class="navbar-option home-btn-nav">
        Home
      </div>
    </div>
  </div>

    <!--ORDER-->

    <div class="search-box-order">
        <input type="text" class="search-input-order" placeholder="Find order">
        <i class="fas fa-search"></i>
    </div>
    
    <br/>
    
    <div>
        <br />
        <div class="card-container">
            {% for order in order_data %}
            {% if order.name or order.phone or order.order or order.address or order.note or order.status %}
            <div class="card">
                <div class="card-header">
                    <span class="customer-name">{{ order.ordercode }}</span>
                    <div class="card-buttons">
                        {% if order.status == "new" %}
                            <button id="edit-modal-button" class="edit-button btn-primary" data-phone="{{ order.phone }}">
                                <i class="fas fa-edit"></i>
                            </button>
                        {% endif %}
                    </div>
                </div>
                {% if order.phone %}
                <div class="card-info">
                    <i class="fas fa-phone"></i>
                    <span>{{ order.phone }}</span>
                </div>
                {% endif %}
                {% if order.name %}
                <div class="card-info">
                    <i class="fas fa-user"></i>
                    <span>{{ order.name }}</span>
                </div>
                {% endif %}
                {% if order.order %}
                <div class="card-info">
                    <i class="fas fa-utensils"></i>
                    <span>{{ order.order }}</span>
                </div>
                {% endif %}
                {% if order.address %}
                <div class="card-info">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>{{ order.address }}</span>
                </div>
                {% endif %}
                {% if order.date %}
                <div class="card-info">
                    <i class="far fa-calendar"></i>
                    <span>{{ order.date }}</span>
                </div>
                {% endif %}
                {% if order.time %}
                <div class="card-info">
                    <i class="far fa-clock"></i>
                    <span>{{ order.time }}</span>
                </div>
                {% endif %}
                {% if order.status %}
                <div class="card-info">
                    <i class="fas fa-info-circle"></i>
                    <span>{{ order.status }}</span>
                </div>
                {% endif %}
                {% if order.note %}
                <div class="card-note">
                    <i class="fas fa-sticky-note"></i>
                    <span>{{ order.note }}</span>
                </div>
                {% endif %}
            </div>
            {% endif %}
            {% endfor %}
    
            <!-- بطاقة جديدة -->
            <div class="card" onclick="makeorder()" style="cursor: pointer;">
                <div class="card-header">
                    <div class="card-add-button">
                        <i class="fas fa-plus"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="floating-form-container">
        <div id="floating-form">
            <h2>طلب جديد</h2>
            <form action="/make-order" method="POST">
                <input type="text" id="order" name="order" placeholder="order" required>
                <a class="openmenubtn" onclick="openMenu()" style="margin-top: 5px !important;">اختيار الوجبة</a>
    
                <div class="overlay" id="overlay">
                    <div class="modal2">
                        <h2>قائمة الوجبات</h2>
                        <select id="meal">
                            <option value="meal1">وجبة 1</option>
                            <option value="meal2">وجبة 2</option>
                            <option value="meal3">وجبة 3</option>
                        </select>
                        <input type="number" id="quantity" placeholder="الكمية" required>
                        <a class="selectbtn" id="selectbtn" onclick="selectMeal()">أضافة</a>
                        <span class="close-btn2" onclick="closeMenu()">&times;</span>
                    </div>
                </div>
    
                <a class="openmenubtn" onclick="openBeverageMenu()">اختيار المشروبات</a>
    
                <div class="overlay" id="beverage-overlay">
                    <div class="modal2">
                        <h2>قائمة المشروبات</h2>
                        <select id="beverage">
                            <option value="beverage1">مشروب 1</option>
                            <option value="beverage2">مشروب 2</option>
                            <option value="beverage3">مشروب 3</option>
                        </select>
                        <input type="number" id="beverage-quantity" placeholder="الكمية" required>
                        <a class="selectbtn" id="select-beverage-btn" onclick="selectBeverage()">أضافة</a>
                        <span class="close-btn2" onclick="closeBeverageMenu()">&times;</span>
                    </div>
                </div>
    
                <a class="openmenubtn" onclick="openAppetizerMenu()">اختيار المقبلات</a>
    
                <div class="overlay" id="appetizer-overlay">
                    <div class="modal2">
                        <h2>قائمة المقبلات</h2>
                        <select id="appetizer">
                            <option value="appetizer1">مقبلة 1</option>
                            <option value="appetizer2">مقبلة 2</option>
                            <option value="appetizer3">مقبلة 3</option>
                        </select>
                        <input type="number" id="appetizer-quantity" placeholder="الكمية" required>
                        <a class="selectbtn" id="select-appetizer-btn" onclick="selectAppetizer()">أضافة</a>
                        <span class="close-btn2" onclick="closeAppetizerMenu()">&times;</span>
                    </div>
                </div>
    
                <a class="openmenubtn" onclick="openSauceMenu()">اختيار الصوصات</a>
    
                <div class="overlay" id="sauce-overlay">
                    <div class="modal2">
                        <h2>قائمة الصوصات</h2>
                        <select id="sauce">
                            <option value="sauce1">صوص 1</option>
                            <option value="sauce2">صوص 2</option>
                            <option value="sauce3">صوص 3</option>
                        </select>
                        <input type="number" id="sauce-quantity" placeholder="الكمية" required>
                        <a class="selectbtn" id="select-sauce-btn" onclick="selectSauce()">أضافة</a>
                        <span class="close-btn2" onclick="closeSauceMenu()">&times;</span>
                    </div>
                </div>
    
                <input type="text" id="phone" name="phone" placeholder="phone number" required>
                <input type="text"id="name" name="name" placeholder="name" required>
                <input type="text" id="address" name="address" placeholder="location"required>
    
                <!--<input type="date" id="date"required>
                            
                <input type="time" id="time" required>-->
                
                <textarea id="note" name="note" placeholder="note"></textarea>
                
                <button type="submit" id="makeorder">إرسال</button>
            </form>
        </div>
    </div>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>

        $(document).ready(function() {
            $('#makeorder').click(function(e) {
                e.preventDefault(); // منع تحميل الصفحة
        
                // جمع البيانات من النموذج
                var order = $('#order').val();
                var phone = $('#phone').val();
                var name = $('#name').val();
                var address = $('#address').val();
                var note = $('#note').val();
        
                // التحقق من صحة المدخلات
                if (order === '' || phone === '' || address === '' || note === '' || name === '') {
                    alert('يرجى ملء جميع الحقول');
                    return;
                }
        
                // إرسال البيانات إلى الخادم
                $.ajax({
                    url: '/make-order',
                    method: 'POST',
                    data: {
                        order: order,
                        phone: phone,
                        name: name,
                        address: address,
                        note: note
                    },
                    success: function(response) {
                        // تنفيذ الإجراءات المطلوبة عند النجاح
                        alert(response); // عرض الاستجابة
        
                        // إفراغ حقول الإدخال
                        $('#order').val('');
                        $('#phone').val('');
                        $('#name').val('');
                        $('#address').val('');
                        $('#note').val('');
        
                        window.location.reload();
                    },
                    error: function(xhr, status, error) {
                        // تنفيذ الإجراءات المطلوبة عند حدوث خطأ
                        alert("حدث خطأ: " + error); // عرض رسالة الخطأ
                    }
                });
            });
        });

        function openMenu() {
            document.getElementById("overlay").style.display = "block";
        }
        
        function closeMenu() {
            document.getElementById("overlay").style.display = "none";
        }
        
        function selectMeal() {
            const meal = document.getElementById("meal").value;
            const quantity = document.getElementById("quantity").value;
            const orderInput = document.getElementById("order");
            orderInput.value += meal + " - " + quantity + ", ";
        }
        
        function selectBeverage() {
            const beverage = document.getElementById("beverage").value;
            const quantity = document.getElementById("beverage-quantity").value;
            const orderInput = document.getElementById("order");
            orderInput.value += beverage + " - " + quantity + ", ";
        }
        
        function selectAppetizer() {
            const appetizer = document.getElementById("appetizer").value;
            const quantity = document.getElementById("appetizer-quantity").value;
            const orderInput = document.getElementById("order");
            orderInput.value += appetizer + " - " + quantity + ", ";
        }
        
        function selectSauce() {
            const sauce = document.getElementById("sauce").value;
            const quantity = document.getElementById("sauce-quantity").value;
            const orderInput = document.getElementById("order");
            orderInput.value += sauce + " - " + quantity + ", ";
        }
        
        function openMenu() {
            document.getElementById("overlay").style.display = "block";
        }
        
        function closeMenu() {
            document.getElementById("overlay").style.display = "none";
        }
        
        function openBeverageMenu() {
            document.getElementById("beverage-overlay").style.display = "block";
        }
        
        function closeBeverageMenu() {
            document.getElementById("beverage-overlay").style.display = "none";
        }
        
        function openAppetizerMenu() {
            document.getElementById("appetizer-overlay").style.display = "block";
        }
        
        function closeAppetizerMenu() {
            document.getElementById("appetizer-overlay").style.display = "none";
        }
        
        function openSauceMenu() {
            document.getElementById("sauce-overlay").style.display = "block";
        }
        
        function closeSauceMenu() {
            document.getElementById("sauce-overlay").style.display = "none";
        }

        function makeorder() {
            document.getElementById('floating-form-container').style.display = 'flex';
          }
          
          // يمكنك إضافة مزيد من الدوال هنا لمعالجة البيانات المُرسلة عبر النموذج

        // routingggggggggggggggg 
    
        function redirectToCustomer() {
            fetch('/customerwin')
              .then(function(response) {
                if (response.ok) {
                  window.location.href = "/customerwin";
                } else {
                  console.log('حدث خطأ في الطلب.');
                }
              })
              .catch(function(error) {
                console.log('حدث خطأ في الاتصال.', error);
              });
        }
    
        //--------------------------------
    
        function searchOrders() {
            var input = searchInputOrder.value.toUpperCase();
            var cards = document.querySelectorAll('.card');
        
            cards.forEach(function(card) {
                var orderCode = card.querySelector('.customer-name');
                var orderCodeText = orderCode.textContent || orderCode.innerText;
                
                var orderPhone = card.querySelector('.card-info:nth-child(2) span:nth-child(2)');
                var orderPhoneText = orderPhone.textContent || orderPhone.innerText;
                
                var orderName = card.querySelector('.card-info:nth-child(3) span:nth-child(2)');
                var orderNameText = orderName.textContent || orderName.innerText;
        
                if (orderCodeText.toUpperCase().indexOf(input) > -1 || 
                    orderPhoneText.toUpperCase().indexOf(input) > -1 || 
                    orderNameText.toUpperCase().indexOf(input) > -1) {
                    card.style.display = "";
                } else {
                    card.style.display = "none";
                }
            });
        }
    
        var searchInputOrder = document.querySelector('.search-input-order');
        searchInputOrder.addEventListener('keyup', searchOrders);
        

        // order & Edit

        var cards = document.querySelectorAll('.card');
    
        function showCardButtons() {
            var editButton = this.querySelector('.edit-button');
            var requestButton = this.querySelector('.request-button');
            
            editButton.style.display = "inline-block";
            requestButton.style.display = "inline-block";
        }
        
        function hideCardButtons() {
            var editButton = this.querySelector('.edit-button');
            var requestButton = this.querySelector('.request-button');
            
            editButton.style.display = "none";
            requestButton.style.display = "none";
        }
        
        cards.forEach(function(card) {
            card.addEventListener('mouseover', showCardButtons);
            card.addEventListener('mouseout', hideCardButtons);
        });

        

        
    </script>
</body>
</html>